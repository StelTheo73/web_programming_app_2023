"use strict";let USER_ITEMS=document.querySelector(".user-items"),SHOW_USER_ITEMS=document.querySelectorAll(".user-items .show-user-item"),ADD_USER_ITEM=document.querySelectorAll(".user-items .add-user-item"),ADDRESS_FORM=document.querySelector("form#add-address-form"),CARD_FORM=document.querySelector("form#add-card-form");function userAddressesListener(){null!=ADDRESS_FORM&&ADDRESS_FORM.addEventListener("submit",function(e){validateAddressForm(e)}),null!=CARD_FORM&&CARD_FORM.addEventListener("submit",function(e){validateCardForm(e)}),null!=USER_ITEMS&&document.addEventListener("click",function(e){let t=e.target,r=USER_ITEMS.querySelector("form #action-type");t.matches(".add-new-user-item-btn")?(r.value="add",changePanel(!1,!0)):t.matches(".close-new-user-item-btn")?(changePanel(!0,!1),null!=ADDRESS_FORM&&clearFormInputs(ADDRESS_FORM),null!=CARD_FORM&&clearFormInputs(CARD_FORM)):t.matches(".fa-edit")?(r.value="edit",fillAddressFormWithUserData(e),changePanel(!1,!0)):t.matches(".fa-trash-alt")&&confirm("Επιθυμείτe να διαγράψετε αυτό το στοιχείο;")&&deleteUserItem(e)})}function changePanel(e,t){!0===e?SHOW_USER_ITEMS.forEach(e=>{e.style.display="flex"}):!1===e&&SHOW_USER_ITEMS.forEach(e=>{e.style.display="none"}),!0===t?ADD_USER_ITEM.forEach(e=>{e.style.display="flex"}):!1===t&&ADD_USER_ITEM.forEach(e=>{e.style.display="none"})}function deleteUserItem(e){let t=e.target.parentNode.parentNode.parentNode.classList[0],r=e.target.parentNode.parentNode.parentNode.id,l=null;t.indexOf("address")>=0?l="addresses":t.indexOf("card")>=0&&(l="cards"),null!==t&&(window.location.href=`/${l}/delete/${r}`)}function validateAddressForm(e){let t=ADDRESS_FORM.querySelector("#action-type"),r=ADDRESS_FORM.querySelector("#address-id"),l=ADDRESS_FORM.querySelector("#city"),a=ADDRESS_FORM.querySelector("#street"),u=ADDRESS_FORM.querySelector("#number"),i=ADDRESS_FORM.querySelector("#country");if(!1===t.checkValidity()||!1===r.checkValidity()||!1===l.checkValidity()||!1===a.checkValidity()||!1===u.checkValidity()||!1===i.checkValidity()){e.preventDefault(),ADDRESS_FORM.classList.add("was-validated");return}t.removeAttribute("disabled"),r.removeAttribute("disabled"),ADDRESS_FORM.classList.add("was-validated")}function validateCardForm(e){let t=CARD_FORM.querySelector("#card_number"),r=CARD_FORM.querySelector("#cvv"),l=CARD_FORM.querySelector("#cardholder"),a=CARD_FORM.querySelector("#expiration_date");(!1===t.checkValidity()||!1===r.checkValidity()||!1===l.checkValidity()||!1===a.checkValidity())&&e.preventDefault();let u=new Date;new Date(a.value)<u?(a.setCustomValidity("Η κάρτα σου έχει λήξει και δε μπορεί να χρησιμοποιηθεί."),a.reportValidity(),e.preventDefault()):a.setCustomValidity(""),CARD_FORM.classList.add("was-validated")}function fillAddressFormWithUserData(e){let t=ADDRESS_FORM.querySelector("#address-id"),r=ADDRESS_FORM.querySelector("#city"),l=ADDRESS_FORM.querySelector("#street"),a=ADDRESS_FORM.querySelector("#number"),u=ADDRESS_FORM.querySelector("#country"),i=u.querySelectorAll("option"),c=ADDRESS_FORM.querySelector("#floor"),d=ADDRESS_FORM.querySelector("#bell"),o=ADDRESS_FORM.querySelector("#postcode"),s=ADDRESS_FORM.querySelector("#note"),S=e.target.parentNode.parentNode.parentNode,n=S.id,R=S.querySelector("input.user-item-city").value,D=S.querySelector("input.user-item-street").value,y=S.querySelector("input.user-item-number").value,A=S.querySelector("input.user-item-floor").value,E=S.querySelector("input.user-item-bell").value,m=S.querySelector("input.user-item-postcode").value,M=S.querySelector("input.user-item-country").value,F=S.querySelector("textarea.user-item-note").innerHTML;for(let v of(t.setAttribute("value",n),r.value=R,l.value=D,a.value=y,c.value=A,d.value=E,o.value=m,s.value=F,i))v.value===M?v.setAttribute("selected",!0):v.removeAttribute("selected")}function clearFormInputs(e){let t=e.querySelectorAll("input");t.forEach(e=>{e.value=""})}export{userAddressesListener};